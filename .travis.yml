language: go
go:
 - 1.12.13

before_install:
 - mkdir -p $GOPATH/src/k8s.io/
 - ln -svf $TRAVIS_BUILD_DIR $GOPATH/src/k8s.io/kubernetes
 - cd $GOPATH/src/k8s.io/kubernetes

script:
 - "go test k8s.io/kubernetes/pkg/kubelet/cm/devicemanager"
 - "make WHAT=cmd/kubelet GOFLAGS=-v"
 - "_output/bin/kubelet --version"
 
deploy:
  provider: releases
  api_key: $GITHUB_ACCESS_TOKEN
  skip_cleanup: true
  file_glob: true
  file: _output/bin/kubelet
